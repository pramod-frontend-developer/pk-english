<!DOCTYPE html>
<html lang="hi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Voice & Text Translator</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Arial", sans-serif;
        background-color: #f8f9fa;
      }
      .main-container {
        padding: 5px;
        margin: auto;
      }
      .input-wrapper {
        position: relative;
        margin-bottom: 20px;
      }
      #textInput {
        width: 100%;
        padding: 15px;
        padding-right: 60px;
        border-radius: 10px;
        border: 2px solid #ddd;
        font-size: 16px;
        box-sizing: border-box;
        outline: none;
      }
      #micBtn {
        position: absolute;
        right: 15px;
        top: 15px;
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        cursor: pointer;
        font-size: 20px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: 0.3s;
      }
      .display-area {
        line-height: 2.8;
        font-size: 20px;
        padding: 25px;
        background-color: #fdfdfd;
        border-radius: 12px;
        border: 1px solid #e0e0e0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        min-height: 150px;
      }
      .word-span {
        display: inline-flex;
        align-items: center;
        margin-right: 15px;
      }
      .clickable-word {
        cursor: pointer;
        padding: 2px 8px;
        border-radius: 6px;
        color: #2c3e50;
        background-color: #f1f3f4;
        transition: all 0.2s;
        font-weight: 500;
      }
      .clickable-word:hover {
        background-color: #d1e7ff;
      }
      .speaker-small {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 14px;
        padding: 0 2px;
        color: #007bff;
        margin-left: 4px;
      }
      #resultCard {
        margin-top: 30px;
        padding: 20px;
        text-align: center;
        background-color: #e8f5e9;
        border-radius: 15px;
        border: 1px solid #a5d6a7;
        display: none; /* Hidden by default */
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <h3 class="text-center text-bg-dark p-3">
          Hello Guy's , Developed by "P K"
        </h3>
      </div>
    </div>
    <div class="main-container">
      <div class="container-fluid">
        <div class="row g-2">
          <div class="col-md-6">
            <h6 class="text-center text-bg-dark rounded-pill p-2">
              Word Click â†’ Hindi Audio Translator
            </h6>
          </div>
          <div class="col-md-6">
            <h6 class="text-center text-bg-dark rounded-pill p-2">
              Smart Voice & Text Translator
            </h6>
          </div>
        </div>
      </div>

      <div class="input-wrapper">
        <textarea
          id="textInput"
          rows="5"
          placeholder="Type karein ya Mic button par click karke boleinn..."
        ></textarea>
        <button id="micBtn" class="btn-primary" title="Bolein (English)">
          ðŸŽ¤
        </button>
        <p
          id="listeningStatus"
          style="
            color: #ff4b2b;
            font-size: 12px;
            margin-top: 5px;
            display: none;
          "
        >
          Listening... Please speak in English
        </p>
      </div>

      <div id="displayArea" class="display-area">
        <p style="color: #999; text-align: center">
          Aapka text yahan clickable words mein dikhega...
        </p>
      </div>

      <div id="resultCard">
        <div style="font-size: 14px; color: #555">
          Word:
          <span
            id="selectedWord"
            style="color: #1b5e20; font-weight: bold"
          ></span>
        </div>
        <div
          style="
            font-size: 32px;
            font-weight: bold;
            color: #2e7d32;
            margin-top: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
          "
        >
          <span id="translatedText">...</span>
          <button
            id="speakHindiBtn"
            style="
              background: none;
              border: none;
              font-size: 28px;
              cursor: pointer;
            "
          >
            ðŸ”Š
          </button>
        </div>
      </div>
    </div>

    <script>
      const textInput = document.getElementById("textInput");
      const displayArea = document.getElementById("displayArea");
      const micBtn = document.getElementById("micBtn");
      const listeningStatus = document.getElementById("listeningStatus");
      const resultCard = document.getElementById("resultCard");
      const selectedWord = document.getElementById("selectedWord");
      const translatedText = document.getElementById("translatedText");
      const speakHindiBtn = document.getElementById("speakHindiBtn");

      let currentTranslation = "";

      // --- Voice Logic (Text to Speech) ---
      function speakHindi(text) {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = "hi-IN";
        utterance.rate = 0.9;
        window.speechSynthesis.speak(utterance);
      }

      function speakEnglish(word) {
        window.speechSynthesis.cancel();
        const cleanWord = word
          .replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "")
          .trim();
        const utterance = new SpeechSynthesisUtterance(cleanWord);
        utterance.lang = "en-US";
        window.speechSynthesis.speak(utterance);
      }

      // --- Speech to Text Logic ---
      const SpeechRecognition =
        window.SpeechRecognition || window.webkitSpeechRecognition;
      if (SpeechRecognition) {
        const recognition = new SpeechRecognition();
        recognition.lang = "en-US";

        micBtn.onclick = () => {
          recognition.start();
        };

        recognition.onstart = () => {
          listeningStatus.style.display = "block";
          micBtn.style.backgroundColor = "#ff4b2b";
          micBtn.innerText = "ðŸ›‘";
        };

        recognition.onresult = (event) => {
          const transcript = event.results[0][0].transcript;
          textInput.value += (textInput.value ? " " : "") + transcript;
          renderWords();
        };

        recognition.onend = () => {
          listeningStatus.style.display = "none";
          micBtn.style.backgroundColor = "#007bff";
          micBtn.innerText = "ðŸŽ¤";
        };
      }

      // --- Translation Logic ---
      async function translateWord(word) {
        const cleanWord = word
          .replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "")
          .trim();
        if (!cleanWord) return;

        resultCard.style.display = "block";
        selectedWord.innerText = cleanWord;
        translatedText.innerText = "...";

        try {
          const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=hi&dt=t&q=${encodeURIComponent(
            cleanWord
          )}`;
          const response = await fetch(url);
          const data = await response.json();
          const hindiResult = data[0][0][0];

          currentTranslation = hindiResult;
          translatedText.innerText = hindiResult;
          speakHindi(hindiResult);
        } catch (error) {
          translatedText.innerText = "N/A";
        }
      }

      // --- Render Words Logic ---
      function renderWords() {
        const text = textInput.value.trim();
        if (!text) {
          displayArea.innerHTML =
            '<p style="color: #999; text-align: center;">Aapka text yahan clickable words mein dikhega...</p>';
          return;
        }

        const words = text.split(/\s+/);
        displayArea.innerHTML = ""; // Clear area

        words.forEach((word) => {
          const spanWrapper = document.createElement("span");
          spanWrapper.className = "word-span";

          const wordEl = document.createElement("span");
          wordEl.className = "clickable-word";
          wordEl.innerText = word;
          wordEl.onclick = () => translateWord(word);

          const speakBtn = document.createElement("button");
          speakBtn.className = "speaker-small";
          speakBtn.innerText = "ðŸ”ˆ";
          speakBtn.onclick = (e) => {
            e.stopPropagation();
            speakEnglish(word);
          };

          spanWrapper.appendChild(wordEl);
          spanWrapper.appendChild(speakBtn);
          displayArea.appendChild(spanWrapper);
        });
      }

      // Listen to typing
      textInput.oninput = renderWords;

      // Result Card Speaker
      speakHindiBtn.onclick = () => speakHindi(currentTranslation);
    </script>
  </body>
</html>
